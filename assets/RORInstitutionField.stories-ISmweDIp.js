import{aF as v,am as I,bZ as C,r as f,j as a,W as j,Y as h,bW as S}from"./iframe-D4dZwAiu.js";import{f as F}from"./fetchWithExponentialTimeout-Dah9kj6g.js";import{A as T}from"./Autocomplete-DZC1cCXx.js";import{u as b}from"./index-DUXFk-b3.js";import"./index-Chi_LkuB.js";import"./usePreviousProps-C19eil-U.js";import"./Chip-BrFyeTvK.js";import"./index-CZtqk19J.js";import"./index-BwN7LX8B.js";async function E(t){return(await F(`https://api.ror.org/v2/organizations?query=${encodeURIComponent(t)}`,{headers:{"Content-Type":"application/json"}})).json()}function V(t,n){const u=v();return I({staleTime:1/0,...n,queryKey:["ror","search",t],queryFn:async()=>{const i=await E(t);return i.items.forEach(o=>{let r=o.id;r.startsWith("https://ror.org/")&&(r=r.split("https://ror.org/")[1]),u.setQueryData(["ror","organization",r],o)}),i}})}function y(t){return t.names.find(n=>n.types.includes("ror_display"))}function c(t){const{value:n,onChange:u=C,error:i}=t,o=n!==void 0,[r,g]=f.useState(""),[d,m]=f.useState("");b(()=>{m(o?n||"":r)},[n,r,o],500);const{data:R,isLoading:x}=V(`${d}`,{enabled:d.length>0});return a.jsx(T,{freeSolo:!0,loading:x,onInputChange:(e,s)=>{o||g(s),u(s)},renderInput:e=>a.jsx(S,{...e,label:"Current Affiliation",placeholder:"Type to search, or enter free text.",error:i}),inputValue:o?n:r,getOptionLabel:e=>typeof e=="string"?e:y(e).value,renderOption:(e,s)=>{const _=y(s).value,O=s.names.filter(p=>!p.types.includes("ror_display"));return a.jsx(j,{component:"li",...e,children:a.jsxs("div",{children:[a.jsx(h,{variant:"body1",children:_}),a.jsx(h,{variant:"smallText1",sx:{color:"grey.700",fontStyle:"italic",fontSize:"11px"},children:O.map(p=>p.value).join(", ")})]})})},filterOptions:e=>e,options:R?.items||[]})}try{c.displayName="RORInstitutionField",c.__docgenInfo={description:`Provides a text field for entering an organization name with an autocomplete dropdown of ROR organizations, fetched from the
ROR API.`,displayName:"RORInstitutionField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(value: string, rorIdentifier?: string) => void"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"boolean"}}}}}catch{}const{fn:q}=__STORYBOOK_MODULE_TEST__,B={title:"Components/RORInstitutionField",component:c,args:{onChange:q()}},l={name:"RORInstitutionField"};l.parameters={...l.parameters,docs:{...l.parameters?.docs,source:{originalSource:`{
  name: 'RORInstitutionField'
}`,...l.parameters?.docs?.source}}};const K=["Demo"];export{l as Demo,K as __namedExportsOrder,B as default};
