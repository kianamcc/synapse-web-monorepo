import{cY as w,bp as C,cZ as q,c_ as p,aF as d,an as r,aG as m,c$ as F,ab as u,am as E,ap as h,r as M,aK as P,d0 as A,ao as v,d1 as G,d2 as Q,d3 as L}from"./iframe-D4dZwAiu.js";import{p as I,i as S}from"./pickBy-Bir1C-NQ.js";import{b}from"./_baseIteratee-hrWHcORH.js";import{u as V}from"./useInfiniteQuery-97YTJVGW.js";import{g as B}from"./InfiniteQueryUtils-CKlRW-xB.js";import{a as D}from"./useEntityBundle-ClqOATdC.js";var O="Expected a function";function R(e){if(typeof e!="function")throw new TypeError(O);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function T(e,t){return I(e,R(b(t)))}const K=(e,t)=>{if(!(C(e)||C(t))&&!(!q(e)||!q(t))&&!(!S(e,void 0)&&!S(t,void 0)))return w(T(e,s=>s===void 0),T(t,s=>s===void 0),K)};function J(e,t){return w(e,t,K)}function U(e,t){const s=new Set;for(const o of e)s.add(o.id);for(const o of t)if(o.id!=null&&!s.has(o.id))throw new Error(`Proposed schema contains a new column model with ID ${o.id} that is not in the old schema.`)}async function x(e,t,s,o){U(s,o);const n=new Map;for(const l of s)n.set(l.id,l);const a=[];for(const l of o){const y={...l};if(y.id!=null){const g=n.get(y.id);g!=null&&!J(g,y)&&delete y.id}a.push(y)}const c=(await p(e,a)).list,i=[],f=new Set;for(let l=0;l<o.length;l++){const y=o[l].id??null,g=c[l].id;y!=null&&f.add(y),f.add(g),y!=null&&y!==g?i.push({oldColumnId:y,newColumnId:g}):y==null&&i.push({oldColumnId:null,newColumnId:g})}for(const l of s){const y=l.id;f.has(y)||i.push({oldColumnId:y,newColumnId:null})}return{concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{concreteType:"org.sagebionetworks.repo.model.table.TableSchemaChangeRequest",entityId:t,changes:i,orderedColumnIds:c.map(l=>l.id)}]}}function ee(e){return e}function N(){const{keyFactory:e,accessToken:t}=r();return(s,o)=>({queryKey:e.getEntityVersionQueryKey(s,o),queryFn:s?()=>u.getEntity(t,s,o?.toString()):v})}function te(e,t,s){const o=N();return E({...s,...o(e,t)})}function ne(e,t){const{accessToken:s,keyFactory:o}=r(),n=M.useMemo(()=>({queries:e.map(a=>({queryKey:o.getEntityVersionQueryKey(a.id,a.versionNumber),queryFn:()=>u.getEntity(s,a.id,a.versionNumber),options:t}))}),[s,e,o,t]);return P(n)}function se(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({mutationFn:n=>u.createEntity(n,s),onSuccess:async(n,a,c)=>{const i=o.getEntityQueryKey(n.id);t.setQueryData(i,n),t.setQueryData(o.getEntityLookupQueryKey({parentId:n.parentId,entityName:n.name}),n.id),await F(t,o,n.id,i),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function oe(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:n=>u.updateEntity(n,s),onSuccess:async(n,a,c)=>{const i=o.getEntityQueryKey(n.id);t.setQueryData(i,n),await F(t,o,n.id,i),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function ae(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:async n=>{const a=await u.getEntity(s,n);return await u.deleteEntity(s,n),a.parentId},onSuccess:async(n,a,c)=>{await F(t,o,a),n&&await F(t,o,n),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function ce(e,t=0,s=200,o){const{accessToken:n,keyFactory:a}=r();return E({...o,queryKey:a.getPaginatedEntityVersionsQueryKey(e,s,t),queryFn:()=>u.getEntityVersions(e,n,t,s)})}function ue(e,t){const{accessToken:o,keyFactory:n}=r();return V({...t,queryKey:n.getEntityVersionsQueryKey(e),queryFn:async a=>await u.getEntityVersions(e,o,a.pageParam,200),initialPageParam:void 0,getNextPageParam:B})}function _(e){return G(e,Q[e.concreteType])}function $(e){return L(e,Q[e.concreteType])}function re(e,t,s,o){const{accessToken:n,keyFactory:a}=r();return E({...o,queryKey:a.getEntityJsonQueryKey(e,t,s),queryFn:()=>u.getEntityJson(e,t,s,n),select:c=>{const i=_(c),f=$(c);return{entity:c,entityMetadata:i,annotations:f}}})}function ie(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:n=>{const a=n.id;return u.updateEntityJson(a,n,s)},onSuccess:async(n,a,c)=>{const i=n.id,f=o.getEntityJsonQueryKey(i,void 0,!1);t.setQueryData(f,n),await F(t,o,i,f),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function ye(e,t){const{accessToken:s,keyFactory:o}=r();return E({...t,queryKey:o.getEntityPathQueryKey(e),queryFn:()=>u.getEntityPath(e,s)})}function le(e,t){const{accessToken:s,keyFactory:o}=r();return E({...t,queryKey:o.getEntityPathQueryKey(e),queryFn:()=>u.getEntityACL(e,s)})}function fe(e,t){const{accessToken:s,keyFactory:o}=r();return E({...t,queryKey:o.getEntityAliasQueryKey(e),queryFn:()=>u.getEntityAlias(e,s)})}function de(e,t,s){const{accessToken:o,keyFactory:n}=r();return E({...s,queryKey:n.getEntityEvaluationsQueryKey(e),queryFn:()=>u.getAllEntityEvaluations(e,t,o)})}function me(e,t){const{accessToken:s,keyFactory:o}=r();return E({...t,queryKey:o.getEntityPermissionsQueryKey(e),queryFn:()=>u.getEntityPermissions(e,s)})}const k=async(e,t,s,o)=>{const n=o.getEntityACLQueryKey(e);t&&s.setQueryData(n,t),await F(s,o,e,n)};function Ee(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:n=>u.createEntityACL(n,s),onSuccess:async(n,a,c)=>{await k(n.id,n,t,o),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function ge(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:n=>u.updateEntityACL(n,s),onSuccess:async(n,a,c)=>{await k(n.id,n,t,o),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function Fe(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:n=>u.deleteEntityACL(n,s),onSuccess:async(n,a,c)=>{await k(a,null,t,o),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function W(e){return D(e,void 0,{includeBenefactorACL:!0},s=>s.benefactorAcl)}function ke(e,t){const s=W(e);return h({...t,...s})}function Ce(e){const t=d(),{accessToken:s,keyFactory:o}=r();return m({...e,mutationFn:async n=>{const a=await x(s,n.entityId,n.originalColumnModels,n.newColumnModels);return u.updateTable(a,s)},onSuccess:async(n,a,c)=>{await F(t,o,a.entityId),e?.onSuccess&&await e.onSuccess(n,a,c)}})}function qe(){const{keyFactory:e,synapseClient:t}=r();return s=>({queryKey:e.getEntityLookupQueryKey(s),queryFn:async()=>(await A(()=>t.entityServicesClient.postRepoV1EntityChild({entityLookupRequest:s})))?.id??null})}export{ke as a,Ee as b,ge as c,Fe as d,ce as e,de as f,ne as g,fe as h,le as i,me as j,N as k,re as l,ae as m,ye as n,ue as o,ie as p,T as q,se as r,ee as s,qe as t,te as u,oe as v,Ce as w};
