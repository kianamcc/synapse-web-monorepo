import{an as o,am as x,aF as d,aG as C,ab as T,r as y,bT as _,j as p,ag as q,bY as F,bU as L}from"./iframe-D4dZwAiu.js";import{u as Q}from"./useInfiniteQuery-97YTJVGW.js";import{A as R}from"./AclEditor-ChIPw7NL.js";import{u as K}from"./useUpdateAcl-CnkTKR45.js";import{c as k,u as P}from"./AccessControlListUtils-DZAIf4AW.js";function H(t){const{synapseClient:s,keyFactory:a}=o();return Q({...t,queryKey:a.getMyOAuthClientsQueryKey(),queryFn:async n=>await s.openIDConnectServicesClient.getAuthV1Oauth2Client({nextPageToken:n.pageParam}),initialPageParam:void 0,getNextPageParam:n=>n.nextPageToken})}function B(t){const s=d(),{accessToken:a,keyFactory:n}=o();return C({...t,mutationFn:e=>T.deleteOAuthClient(e,a),onSuccess:async(e,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),t?.onSuccess&&await t.onSuccess(e,i,c)}})}function W(t){const s=d(),{synapseClient:a,keyFactory:n}=o();return C({...t,mutationFn:e=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientId({id:e.client_id,oAuthClient:e}),onSuccess:async(e,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),t?.onSuccess&&await t.onSuccess(e,i,c)}})}function Y(t){const s=d(),{synapseClient:a,keyFactory:n}=o();return C({...t,mutationFn:e=>a.openIDConnectServicesClient.postAuthV1Oauth2Client({oAuthClient:e}),onSuccess:async(e,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),t?.onSuccess&&await t.onSuccess(e,i,c)}})}function D(t,s){const{synapseClient:a,keyFactory:n}=o();return x({...s,queryKey:n.getOAuthClientAclQueryKey(t),queryFn:()=>a.openIDConnectServicesClient.getAuthV1Oauth2ClientIdAcl({id:t})})}function N(t){const s=d(),{synapseClient:a,keyFactory:n}=o();return C({...t,mutationFn:e=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientIdAcl({id:e.id,accessControlList:e}),onSuccess:async(e,i,c)=>{const A=n.getOAuthClientAclQueryKey(e.id);if(s.setQueryData(A,e),t?.onSuccess)return await t.onSuccess(e,i,c)}})}const b=["CAN_ADMINISTER_OAUTH_CLIENT"],f=y.forwardRef(function(s,a){const{clientId:n,onSaveComplete:e}=s,[i,c]=y.useState(null),A=()=>{c(null),e(!0)},S=u=>{c(u.reason),e(!1)},{data:r,isLoading:g}=D(n,{staleTime:1/0}),{resourceAccessList:l,setResourceAccessList:h,addResourceAccessItem:I,updateResourceAccessItem:O,removeResourceAccessItem:v,resetDirtyState:E}=K({onChange:()=>c(null),onError:c});y.useEffect(()=>{r&&(E(),h(k(r.resourceAccess)))},[r,h]);const{mutate:m}=N({onSuccess:()=>A(),onError:u=>S(u)});return y.useImperativeHandle(a,()=>({save(){const u=P(r,l);r===null&&u==null||_(r?.resourceAccess,l)&&r?.id===u?.id?e(!0):m(u)}}),[n,r,l,e,m]),p.jsxs(q,{direction:"column",sx:{gap:"20px"},children:[p.jsx(R,{resourceAccessList:l,availablePermissionLevels:b,isLoading:g,canEdit:!0,emptyText:"",onAddPrincipalToAcl:u=>I(u,F("CAN_ADMINISTER_OAUTH_CLIENT")),updateResourceAccessItem:O,removeResourceAccessItem:v,showAddRemovePublicButton:!1,showNotifyCheckbox:!1,isInherited:!1}),i&&p.jsx(L,{severity:"error",children:i})]})});try{f.displayName="OAuthClientAclEditor",f.__docgenInfo={description:"",displayName:"OAuthClientAclEditor",props:{clientId:{defaultValue:null,description:"",name:"clientId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}export{f as O,W as a,B as b,H as c,Y as u};
