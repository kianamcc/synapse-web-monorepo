import{V as L,j as e,hZ as b,G as N,dA as O,eH as z,an as v,r as w,dF as S,h_ as M,b$ as E,e7 as P,h$ as q,c4 as H,W as k,B as j,i0 as B,Y as h}from"./iframe-Dmz0OYQW.js";import{u as R}from"./useDownloadList-CFpd7DrF.js";import{d as V}from"./duration-DbmI10NM.js";import{r as U}from"./relativeTime-DVX9LeFM.js";import{S as T}from"./SkeletonInlineBlock-DMCr-ZDU.js";import{T as C}from"./SynapseTableConstants-2qH3fDlQ.js";const W=L([e.jsx("path",{d:"M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8m4.2 12.2L11 13V7h1.5v5.2l4.5 2.7z",opacity:".3"},"0"),e.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7z"},"1")]),Y=200,_="ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME",I="ESTIMATED_DOWNLOAD_SPEED",G="syn12600511",Z=i=>new Promise((t,s)=>{const o=localStorage.getItem(_),r=localStorage.getItem(I);if(o&&r&&new Date().getTime()<Number(o)){t(Number(r));return}b(i,G).then(a=>{const d=a,l={includeFileHandles:!0,includePreSignedURLs:!0,includePreviewPreSignedURLs:!1,requestedFiles:[{associateObjectId:d.id,associateObjectType:N.FileEntity,fileHandleId:d.dataFileHandleId}]};O(l,i).then(n=>{const p=n.requestedFiles[0].preSignedURL,c=n.requestedFiles[0].fileHandle,x=new Date().getTime();return z(c,p).then(()=>{const f=c.contentSize/((new Date().getTime()-x-Y)/1e3),y=new Date().getTime();localStorage.setItem(_,(y+1e3*60*5).toString()),localStorage.setItem(I,f.toString()),t(f)})})}).catch(a=>s(a))});S.extend(V);S.extend(U);function g(i){const{numFiles:t,numBytes:s}=i,{accessToken:o,isAuthenticated:r}=v(),a=!!s,[d,m]=w.useState({isLoading:a,downloadSpeed:0}),{isLoading:l,downloadSpeed:n}=d;w.useEffect(()=>{r&&Z(o).then(A=>{m({isLoading:!1,downloadSpeed:A})})},[r,o]);const p=l||n===0||!s?0:s/n,c=p===0,x=c?"":S.duration({seconds:p}).humanize(),f=t===0,y=f?"SRC-inactive":"SRC-primary-text-color",D=c?"SRC-inactive":"SRC-primary-text-color";return e.jsxs("span",{className:"download-details-container",children:[t!=null&&e.jsxs("span",{children:[e.jsx(M,{className:y}),f?e.jsx(T,{width:50}):e.jsxs(e.Fragment,{children:[t.toLocaleString(),"Â files"]})]}),a&&e.jsx(E,{title:"This is the total size of all files. Zipped package(s) will likely be smaller.",enterNextDelay:C,placement:"top",children:e.jsxs("span",{"data-testid":"numBytesUI",children:[e.jsx(q,{className:D}),c?e.jsx(T,{width:50}):P(s)]})}),a&&e.jsx(E,{title:"This is an estimate of how long package download will take.",enterNextDelay:C,placement:"top",children:e.jsxs("span",{"data-testid":"downloadTimeEstimateUI",children:[e.jsx(W,{className:D}),l&&t!=null&&t>0?e.jsx(T,{width:50}):x]})})]})}try{g.displayName="DownloadDetails",g.__docgenInfo={description:`Displays download information including number of files, size of download, and time to download.
Prefer to use {@link ../DownloadCart/DownloadDetails} instead, particularly when you have information about file packaging in/eligibility`,displayName:"DownloadDetails",props:{numFiles:{defaultValue:null,description:"",name:"numFiles",required:!1,type:{name:"number"}},numBytes:{defaultValue:null,description:"",name:"numBytes",required:!1,type:{name:"number"}}}}}catch{}const u={2:{severity:"info",infoText:"Would you like to add these files to the download cart?",closeText:"Cancel"},3:{severity:"info",infoText:e.jsxs(e.Fragment,{children:["Note: Files that you add will be mixed in with the files already in your download cart.",e.jsx("br",{}),"If you don't want to mix these files, clear your download cart before continuing."]}),closeText:"Cancel"},1:{severity:"info",infoText:"Adding files to download cart",closeText:"Cancel"},0:{severity:"info",infoText:"Calculating file size",closeText:"Cancel"},4:{severity:"error",closeText:"Close",infoText:e.jsxs(e.Fragment,{children:["Please ",e.jsx(B,{})," to add files to your download cart."]})}};function K(i){const{status:t,fileCount:s,fileSize:o}=i;switch(t){case 0:case 1:return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner white"}),e.jsx(h,{variant:"smallText1",children:u[t].infoText})]});case 4:return e.jsx(h,{variant:"smallText1",children:u[t].infoText});case 2:case 3:return e.jsxs(e.Fragment,{children:[e.jsx(g,{numFiles:s,numBytes:o}),e.jsx(h,{variant:"smallText1",sx:{flexGrow:1},children:u[t].infoText})]});default:return e.jsx(e.Fragment,{})}}function F(i){const{onAddToDownloadCart:t,onCancel:s,fileCount:o,fileSize:r,isLoadingStats:a=!1,isAddingToDownloadCart:d=!1}=i,{isAuthenticated:m}=v(),{data:l}=R(),n=w.useMemo(()=>m?a?0:d?1:l&&l.totalNumberOfFiles>0?3:2:4,[m,a,d,l]);return e.jsx(e.Fragment,{children:e.jsx(H,{sx:{pr:4,py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},icon:u[n].severity==="error"?void 0:!1,severity:u[n].severity,className:"download-confirmation",action:e.jsxs(e.Fragment,{children:[n!==1&&e.jsx(j,{variant:"text",color:"primary",onClick:s,children:u[n].closeText}),(n===2||n===3)&&e.jsx(j,{variant:"contained",color:"primary",onClick:()=>{t()},sx:{ml:"5px"},children:"Add"})]}),children:e.jsx(k,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(K,{status:n,fileCount:o,fileSize:r})})})})}try{F.displayName="DownloadConfirmationUI",F.__docgenInfo={description:`This component is used to display the download confirmation dialog that presents to a user the number of files and the
total size of the files they are about to add to their download cart.`,displayName:"DownloadConfirmationUI",props:{onAddToDownloadCart:{defaultValue:null,description:"",name:"onAddToDownloadCart",required:!0,type:{name:"() => void"}},fileCount:{defaultValue:null,description:"",name:"fileCount",required:!1,type:{name:"number"}},fileSize:{defaultValue:null,description:"",name:"fileSize",required:!1,type:{name:"number"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},isLoadingStats:{defaultValue:null,description:"",name:"isLoadingStats",required:!1,type:{name:"boolean"}},isAddingToDownloadCart:{defaultValue:null,description:"",name:"isAddingToDownloadCart",required:!1,type:{name:"boolean"}}}}}catch{}export{F as D};
