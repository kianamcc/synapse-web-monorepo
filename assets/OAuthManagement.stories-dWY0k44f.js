import{V as N,j as e,ao as P,r as o,W as G,B as T,dX as Y,$,dH as A,dG as O,ab as q,K,bs as X,cu as J}from"./iframe-CkxBXYUS.js";import{I as Q}from"./InfiniteTableLayout-3AGD4SbY.js";import{c as U}from"./OAuthClientAclEditor-PrcG0XZ6.js";import{u as Z,g as ee,S as te,c as oe}from"./StyledTanStackTable-7N057WXO.js";import{C as ie}from"./CopyToClipboardInput-wFvAw_qE.js";import{D as k}from"./DialogBase-A-L2CAQ2.js";import{W as ne}from"./WarningDialog-BO6fLCY6.js";import{C as d}from"./ColumnHeader-R9oXeK2F.js";import{C as se,O as re}from"./OAuthAclEditorModal-BQabXKFa.js";import{M as C}from"./MenuItem-CEfDuclk.js";import"./index-Chi_LkuB.js";import"./useInfiniteQuery-GEnPT25t.js";import"./AclEditor-BhqUh4rQ.js";import"./useRealmPrincipals-BjOTp7Ah.js";import"./UserSearchBoxV2-BMsAnB-J.js";import"./useDebouncedEffect-CnSqEB5d.js";import"./use-deep-compare-effect.esm-CITT_kVX.js";import"./uniq-xfdkBigH.js";import"./without-CIQb-7Wr.js";import"./UserBadge-CJBqeQOM.js";import"./useUserBundle-r9Y7ADD5.js";import"./useSuspenseQuery-CY63kBJ7.js";import"./SkeletonTable-BxoX6BC7.js";import"./Card-h-vZuF9_.js";import"./Chip-CZ1spSeI.js";import"./Select-aab027f3.esm-CFvBkQoo.js";import"./defineProperty-Cp4flQ_6.js";import"./toPropertyKey-C9c9JG92.js";import"./UserOrTeamBadge-BR8gNaFS.js";import"./TeamBadge-8mUTW7Hv.js";import"./SkeletonButton-BkLf8D0r.js";import"./SkeletonInlineBlock-DEQxpJiN.js";import"./SkeletonParagraph-DYUWrGET.js";import"./IconSvgButton-c95hntOq.js";import"./FormControlLabel-DRB2gJy9.js";import"./Checkbox-BdBxDy6O.js";import"./SwitchBase-fsEWQiIL.js";import"./useUpdateAcl-y5_nlNly.js";import"./AccessControlListUtils-B_4L3kbp.js";import"./StyledTableContainer-DyMh-6Tv.js";import"./ExpandCollapseButton-CjtPIllN.js";import"./index-5DbLubiq.js";import"./ContentCopy-BTyaGP3s.js";import"./InputAdornment-DGo24dSd.js";import"./Close-CMCH1D24.js";import"./HelpPopover-8rjafscZ.js";import"./MarkdownPopover-3C7AALW8.js";import"./LightTooltip-iqHVnLEB.js";import"./MarkdownSynapse-Cl6WuhRF.js";import"./ConfirmationDialog-CtJfMeS4.js";import"./EnumFacetFilterUI-DM_updv0.js";import"./FacetFilterHeader-BDt2ZqrE.js";import"./Radio-CNEljpXE.js";import"./HelpTwoTone-CeX0v0h9.js";import"./GridLegacy-DWVl_W8h.js";const ae=N(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),p=oe();function le(i){const{setIsShowingVerification:s,setSelectedClient:l,setIsShowingSecretWarning:u,setIsEdit:n,setIsShowingCreateClientModal:c,setIsShowingSharingSettings:r}=i;return[p.accessor("createdOn",{header:t=>e.jsx(d,{...t,title:"Created"}),cell:t=>A(O(t.getValue()))}),p.accessor("modifiedOn",{header:t=>e.jsx(d,{...t,title:"Modified"}),cell:t=>A(O(t.getValue()))}),p.accessor("client_id",{header:t=>e.jsx(d,{...t,title:"ID"})}),p.accessor("client_name",{header:t=>e.jsx(d,{...t,title:"Client"})}),p.accessor("verified",{header:t=>e.jsx(d,{...t,title:"Verified"}),cell:({getValue:t})=>t()?"Yes":e.jsx(T,{variant:"outlined",size:"small",onClick:()=>s(!0),children:"Submit Verification"})}),p.display({id:"actions",header:t=>e.jsx(d,{...t,title:"Actions"}),cell:({row:t})=>e.jsx(ce,{row:t,setSelectedClient:l,setIsEdit:n,setIsShowingCreateClientModal:c,setIsShowingSecretWarning:u,setIsShowingSharingSettings:r})})]}function ce({row:i,setSelectedClient:s,setIsEdit:l,setIsShowingCreateClientModal:u,setIsShowingSecretWarning:n,setIsShowingSharingSettings:c}){const[r,t]=o.useState(null),h=!!r,f=S=>{t(S.currentTarget)},m=()=>{t(null)};return e.jsxs(e.Fragment,{children:[e.jsx(X,{"aria-label":"more","aria-controls":`actions-menu-${i.id}`,"aria-haspopup":"true",onClick:f,size:"small",children:e.jsx(ae,{})}),e.jsxs(J,{id:`actions-menu-${i.id}`,anchorEl:r,open:h,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(C,{onClick:()=>{s(i.original),l(!0),u(!0),m()},children:"Edit"}),e.jsx(C,{onClick:()=>{s(i.original),n(!0),m()},children:"Generate Secret"}),e.jsx(C,{onClick:()=>{s(i.original),c(!0),m()},children:"Sharing Settings"})]})]})}function me(){const{accessToken:i}=P(),[s,l]=o.useState(!1),[u,n]=o.useState(!1),[c,r]=o.useState(!1),[t,h]=o.useState(),[f,m]=o.useState(!1),[S,x]=o.useState(!1),[E,j]=o.useState(!1),[w,M]=o.useState(),[V,I]=o.useState(!1),{data:b,isLoading:y,hasNextPage:B,fetchNextPage:D,isFetchingNextPage:_}=U(),R=o.useMemo(()=>b?.pages.flatMap(a=>a.results||[])||[],[b]),W="Are you absolutely sure?",z="If you have an existing secret, generating a new secret will make your application invalid after generation. This action cannot be undone.",F=async()=>{x(!1);try{const a=await q.createOAuthClientSecret(i,t?.client_id);h(void 0),j(!0),M(a.client_secret)}catch(a){K(a.reason,"danger")}},H=o.useMemo(()=>le({setIsShowingVerification:I,setSelectedClient:h,setIsShowingSecretWarning:x,setIsEdit:r,setIsShowingCreateClientModal:n,setIsShowingSharingSettings:l}),[]),v=Z({data:R,columns:H,getRowId:a=>a.client_id,enableRowSelection:!0,enableSorting:!1,getCoreRowModel:ee(),columnResizeMode:"onChange"}),L=!y&&v.getRowModel().rows.length===0;return e.jsxs("div",{children:[e.jsx(G,{sx:{display:"flex",width:"100%",justifyContent:"flex-end",mb:2},children:e.jsx(T,{variant:"contained",color:"primary",onClick:()=>{n(!0),r(!1)},sx:{float:"right"},startIcon:e.jsx(Y,{}),children:"Create New Client"})}),e.jsx(Q,{table:e.jsx(te,{table:v}),isLoading:y,isEmpty:L,hasNextPage:B,onFetchNextPageClicked:()=>{D()},isFetchingNextPage:_}),e.jsx(se,{onClose:()=>{n(!1)},isShowingModal:u,client:c?t:void 0,isEdit:c,setIsShowingConfirmModal:m,isShowingConfirmModal:f,setIsShowingModal:n}),e.jsx(k,{open:V,onCancel:()=>I(!1),title:"Submit Verification",content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["In order to verify an OAuth client please submit a request to the"," ",e.jsx($,{target:"_blank",rel:"noopener noreferrer",href:"https://sagebionetworks.jira.com/servicedesk/customer/portal/9",children:"Synapse Service Desk."})]}),e.jsx("b",{children:"Please list the following items in your request:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Your name"}),e.jsxs("li",{children:["The ID of the client to be verified ",e.jsx("br",{})]}),e.jsx("li",{children:"A description of your application"})]})]})}),e.jsx(re,{clientId:t?.client_id,open:s,onClose:()=>l(!1)}),e.jsx(ne,{open:S,title:W,content:z,onCancel:()=>{x(!1),h(void 0)},onConfirm:F,confirmButtonColor:"error",confirmButtonText:"Yes, Continue"}),w&&e.jsx(k,{open:E,title:"App Secret",onCancel:()=>{j(!1),M(void 0)},content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("b",{children:"This secret will not be able to be retrieved again."})," If needed, in order to generate a new secret select Generate from the Client List."]}),e.jsx(ie,{value:w,inputWidth:"400px"})]})})]})}const pt={title:"Synapse/OAuthManagement",component:me},g={};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:"{}",...g.parameters?.docs?.source}}};const ut=["OAuthManagementDemo"];export{g as OAuthManagementDemo,ut as __namedExportsOrder,pt as default};
